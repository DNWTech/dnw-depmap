DNW-depmap
=============

DNW-depmap is an Eclipse plug-in project to create Java code dependency map,
which can be used by developers to help them easily find what's the influence of arbitrary code modifications.

Development Environment
-----------------------
- JDK 1.7 (Neo4j graph database's prerequisites)
- Eclipse 3.7 (code name Indigo)
  - Import [codetemplates.xml](https://github.com/manbaum/dnw-depmap/blob/develop/codetemplates.xml) into ```Preferences|Java|Code Style|Code Templates```.
  - Import [codestyle.xml](https://github.com/manbaum/dnw-depmap/blob/develop/codestyle.xml) into ```Preferences|Java|Code Style|Formatter```.
- Format the code before commit. Thanks.

Getting Start
-------------
1. Download Neo4j v2.1.5 from [the Neo4j site](http://neo4j.com/download/).
2. Follow [these instructions](http://neo4j.com/docs/2.1.5/deployment.html) to install and deploy a local Neo4j server.
   But do *NOT* start the server at now!
3. Import the forked project into Eclipse (the *first* Eclipse).
4. Configure ```DBPATH``` in ```com.dnw.depmap.Activator.java``` to the database store directory
   of the local Neo4j server.
4. Build and run this project as an ```Eclipse Application``` (the *second* Eclipse).
5. In the second Eclipse, import a Java project into its workspace.
6. Build the Java project to make sure these's no syntax error.
7. In the ```Package Explorer``` window, select one or more Java elements (may be Java files, packages,
   or even the Java project), right click on them and select ```Analysis Dependency``` from the pop-up context menu.
8. Wait for done. (if there are a lot of Java files in the selection, it maybe a long moment.)
9. Close the second Eclipse. (*MUST* close it before the next step!)
10. Startup the local Neo4j server, open a browser and navigate to [http://localhost:7474/browser](http://localhost:7474/browser). 
11. Now you can write Neo4j Cypher queries to manipulate the data generated by this program.
    e.g. ```match p=((:Class)-[:Declares]->(:Method)-[:Invokes]->(:Method)<-[:Declares]-(:Class {name:"java.lang.Object"})) return p```.
12. Note: Shutdown the local Neo4j server before re-generating data.

Data Model
----------
- Node labeled ```Type``` will also be labeled either ```Class``` or ```Interface```.
- Node labeled ```Class``` denotes a Java class.
  - Property ```name```: the qualified name of the class, with all type parameters replaced with ```'?'```. e.g. ```'java.util.ArrayList<?>'```.
  - Property ```caption```: the simple name (no package name) of the class, with the bound type parameters. e.g. ```'ArrayList<Object>'```.
  - Property ```extends```: the qualified name of its superclass. e.g. ```'java.lang.Object'```. 
  - Property ```implements```: an array contains all names of interfaces which implements. e.g. ```['java.util.List<?>']```. 
- Node labeled ```Interface``` denotes a Java interface. 
  - Property ```name```: the qualified name of the interface, with all type parameters replaced with ```'?'```. e.g. ```'java.util.List<?>'```.
  - Property ```caption```: the simple name (no package name) of the interface, with the bound type parameters. e.g. ```'List<Object>'```. 
  - Property ```extends```: an array contains all names of interfaces which extends. e.g. ```['java.util.Collection<?>']```.
- Relation type ```Extends``` denotes the class inheritance happened between two ```Class``` nodes, or the interface inheritance happened between two ```Interface``` nodes.
- Relation type ```Implements``` denotes the interface implementation between a ```Class``` node and a ```Interface``` node.
- Node labeled ```Method``` denotes a Java method.
  - Property ```name```: consists of two parts: 1) the qualified name of its declaring class, 2) the method declaring, made by the method name and all the arguments' type names in parentheses.
    * For a static method, uses ```'/'``` as the delimiter. e.g. ```'java.util.Arrays/asList(java.lang.Object[])'```.
    * For a non-static method, uses ```'#'``` as the delimiter. e.g. ```'java.lang.Object#wait()'```.
  - Property ```caption```: concatenates the method name and the number of declaring arguments in parentheses. e.g. ```'asList(1)'```.
- Relation type ```Declares``` denotes the method declaration, the left/from side should be a ```Type``` node, and the right/to side should be a ```Method``` node.
- Relation type ```Invokes``` denotes the method invocation, it happens between two ```Method``` nodes.
 - Property ```args```: an array contains all arguments passed in when the invocation happens.

License
-------
Copyright (c) 2014 DNW Technologies and others.<br/>
All rights reserved. This program and the accompanying materials<br/>
are made available under the terms of the Eclipse Public License v1.0<br/>
which accompanies this distribution, and is available at<br/>
http://www.eclipse.org/legal/epl-v10.html
